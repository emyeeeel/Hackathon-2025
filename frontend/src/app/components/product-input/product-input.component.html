<div class="product-input-container">
    <h2>Product Input</h2>

    <div class="image-input-options">
        <h3>Add Product Image</h3>

        <div class="option-buttons">
            <div class="option">
                <button class="option-button url-button" (click)="selectImageOption('url')">
                    <span class="option-text">Enter Image URL</span>
                </button>
            </div>

            <div class="option">
                <button class="option-button upload-button" (click)="selectImageOption('upload')">
                    <span class="option-text">Upload Image</span>
                </button>
            </div>
        </div>

        <!-- URL Input Section -->
        <div class="url-input-section" *ngIf="selectedOption === 'url'">
            <div class="input-group">
                <label for="image-url">Image URL:</label>
                <input type="text" id="image-url" [(ngModel)]="imageUrl" />
            </div>
            <button class="submit-button" (click)="submitImageUrl()">Submit URL</button>

            <!-- Progress Bar for URL -->
            <div class="progress-bar-container" *ngIf="urlUploadProgress > 0">
                <div class="progress-bar-wrapper">
                    <div 
                        class="progress-bar" 
                        [style.width.%]="urlUploadProgress">
                        <span class="progress-percentage">{{ urlUploadProgress }}%</span>
                    </div>
                </div>
            </div>

            <!-- Image Preview for URL -->
            <div class="image-preview" *ngIf="imagePreviewUrl && urlUploadProgress === 100">
                <img [src]="imagePreviewUrl" alt="Image Preview" class="preview-image" />
            </div>

            <!-- Product Details for URL -->
            <div class="product-details" *ngIf="identifiedProduct && urlUploadProgress === 100">
                <h3>Product Details</h3>
                <div class="product-card">
                    <p><strong>Name:</strong> {{ identifiedProduct.name }}</p>
                    <p><strong>Description:</strong> {{ identifiedProduct.description === '' ? 'N/A' : identifiedProduct.description }}</p>
                    <p><strong>Category:</strong> {{ identifiedProduct.category }}</p>
                    <p><strong>Subcategory:</strong> {{ identifiedProduct.subcategory }}</p>
                    <p><strong>Dimensions:</strong> {{ identifiedProduct.width }} x {{ identifiedProduct.height }} x {{ identifiedProduct.length }} cm</p>
                    <p><strong>Weight:</strong> {{ identifiedProduct.weight }} kg</p>
                    <p><strong>Quantity:</strong> {{ identifiedProduct.quantity }}</p>
                    <p><strong>Fragile:</strong> {{ identifiedProduct.is_fragile ? 'Yes' : 'No' }}</p>
                    <p><strong>Requires Refrigeration:</strong> {{ identifiedProduct.requires_refrigeration ? 'Yes' : 'No' }}</p>
                </div>
            </div>
        </div>

        <!-- File Upload Section -->
        <div class="file-upload-section" *ngIf="selectedOption === 'upload'">
            <div class="upload-area" 
                 (dragover)="onDragOver($event)" 
                 (dragleave)="onDragLeave($event)" 
                 (drop)="onDrop($event)"
                 [class.active]="isDragging">
                <p class="upload-text">Drag and Drop file here or <span class="choose-file" (click)="fileInput.click()">Choose file</span></p>
                <input 
                  type="file" 
                  id="file-upload" 
                  accept="image/*" 
                  (change)="onFileSelected($event)"
                  #fileInput
                  hidden
                >
            </div>
            <div class="file-info">
                <p>Supported formats: JPG, PNG, GIF</p>
                <p>Maximum size: 5MB</p>
            </div>
            <div class="progress-bar-container" *ngIf="uploadProgress > 0">
                <div class="progress-bar-wrapper">
                    <div 
                        class="progress-bar" 
                        [style.width.%]="uploadProgress">
                        <span class="progress-percentage">{{ uploadProgress }}%</span>
                    </div>
                </div>
            </div>
            <div class="image-preview" *ngIf="imagePreviewUrl && uploadProgress === 100">
                <img [src]="imagePreviewUrl" alt="Image Preview" class="preview-image" />
            </div>

            <!-- Product Details for File Upload -->
            <div class="product-details" *ngIf="identifiedProduct && uploadProgress === 100">
                <h3>Product Details</h3>
                <div class="product-card">
                    <p><strong>Name:</strong> {{ identifiedProduct.product?.name }}</p>
                    <p><strong>Description:</strong> {{ identifiedProduct.product?.description === '' ? 'N/A' : identifiedProduct.product?.description }}</p>
                    <p><strong>Category:</strong> {{ identifiedProduct.product?.category }}</p>
                    <p><strong>Subcategory:</strong> {{ identifiedProduct.product?.subcategory }}</p>
                    <p><strong>Dimensions:</strong> {{ identifiedProduct.product?.width }} x {{ identifiedProduct.product?.height }} x {{ identifiedProduct.product?.length }} cm</p>
                    <p><strong>Weight:</strong> {{ identifiedProduct.product?.weight }} kg</p>
                    <p><strong>Quantity:</strong> {{ identifiedProduct.product?.quantity }}</p>
                    <p><strong>Fragile:</strong> {{ identifiedProduct.product?.is_fragile ? 'Yes' : 'No' }}</p>
                    <p><strong>Requires Refrigeration:</strong> {{ identifiedProduct.product?.requires_refrigeration ? 'Yes' : 'No' }}</p>
                </div>
            </div>
        </div>
    </div>
</div>